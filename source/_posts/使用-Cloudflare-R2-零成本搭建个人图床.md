---
title: ä½¿ç”¨ Cloudflare R2 é›¶æˆæœ¬æ­å»ºä¸ªäººå›¾åºŠ
date: 2026-01-13 10:37:05
tags:
  - cloudflare
  - å›¾åºŠ
  - S3
categorys:
  - æŠ€æœ¯
---
åœ¨å†™åšå®¢æˆ–è€…ç»´æŠ¤ç½‘ç«™æ—¶ï¼Œå›¾ç‰‡çš„æ‰˜ç®¡ä¸€ç›´æ˜¯ä¸ªè®©äººå¤´ç–¼çš„é—®é¢˜ã€‚æ”¾åœ¨æœ¬åœ°ä¼šå¢åŠ  Git ä»“åº“ä½“ç§¯ï¼Œä½¿ç”¨å…¬å…±å›¾åºŠåˆæ‹…å¿ƒéšæ—¶â€œè·‘è·¯â€ã€‚ä»Šå¤©ä»‹ç»å¦‚ä½•åˆ©ç”¨ Cloudflare R2 æ­å»ºä¸€ä¸ªé«˜é€Ÿã€ç¨³å®šä¸”å‡ ä¹å…è´¹çš„ä¸ªäººå›¾åºŠã€‚

å¦å¤–ï¼Œå¯¹è±¡å­˜å‚¨åœ¨æŠ˜è…¾ serverless çš„æ—¶å€™ä¹Ÿæ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚
## ä»€ä¹ˆæ˜¯å¯¹è±¡å­˜å‚¨ï¼Ÿ

åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä»€ä¹ˆæ˜¯**å¯¹è±¡å­˜å‚¨**ã€‚

ç®€å•æ¥è¯´ï¼Œå¯¹è±¡å­˜å‚¨æ˜¯ä¸€ç§ä¸“é—¨ä¸ºå¤§è§„æ¨¡éç»“æ„åŒ–æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ã€è§†é¢‘ã€å¤‡ä»½æ–‡ä»¶ç­‰ï¼‰è®¾è®¡çš„å­˜å‚¨æ¶æ„ã€‚ä¸ä¼ ç»Ÿç”µè„‘ä¸Šçš„â€œå±‚çº§æ–‡ä»¶ç³»ç»Ÿâ€ï¼ˆæ–‡ä»¶å¤¹åµŒå¥—ï¼‰ä¸åŒï¼Œå¯¹è±¡å­˜å‚¨å°†æ•°æ®ä½œä¸ºâ€œå¯¹è±¡â€è¿›è¡Œç®¡ç†ï¼š

* **å¯¹è±¡ï¼ˆObjectï¼‰**ï¼šåŒ…å«æ•°æ®æœ¬èº«ã€å…ƒæ•°æ®ï¼ˆMetadataï¼‰å’Œå…¨å±€å”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼ˆIDï¼‰ã€‚
* **æ¡¶ï¼ˆBucketï¼‰**ï¼šå­˜æ”¾å¯¹è±¡çš„å®¹å™¨ã€‚
* **ç‰¹æ€§**ï¼šå®ƒå…·æœ‰æé«˜çš„æ‰©å±•æ€§å’Œå¯é æ€§ï¼Œé€šè¿‡ API æˆ– URL ç›´æ¥è®¿é—®ï¼Œéå¸¸é€‚åˆä½œä¸ºç½‘ç«™çš„é™æ€èµ„æºå­˜å‚¨ã€‚

å¸¸è§çš„å¯¹è±¡å­˜å‚¨æœåŠ¡æœ‰äºšé©¬é€Šçš„ AWS S3ã€é˜¿é‡Œäº‘çš„ OSS å’Œè…¾è®¯äº‘çš„ COSã€‚

### ä»€ä¹ˆæ˜¯ S3 API ?

**AWS S3 (Simple Storage Service)** çš„ API æ˜¯ç›®å‰äº‘å­˜å‚¨è¡Œä¸šçš„**äº‹å®æ ‡å‡†**ã€‚ç»å¤§å¤šæ•°çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆåŒ…æ‹¬ Cloudflare R2ã€é˜¿é‡Œäº‘ OSSã€è…¾è®¯äº‘ COSã€MinIOï¼‰éƒ½å®Œå…¨å…¼å®¹ S3 APIã€‚

ç†è§£äº† S3 API çš„ç”¨æ³•ï¼Œä½ å°±å¯ä»¥ä¸€å¥—ä»£ç é€šç”¨æ‰€æœ‰ä¸»æµäº‘å­˜å‚¨ã€‚
#### å‡†å¤‡å·¥ä½œ

åœ¨ä½¿ç”¨ API ä¹‹å‰ï¼Œä½ å¿…é¡»æ‹¥æœ‰ï¼š
1. **Access Key ID** (è®¿é—®å¯†é’¥ ID)
2. **Secret Access Key** (ç§æœ‰è®¿é—®å¯†é’¥)
3. **Endpoint URL** (ç»ˆç»“ç‚¹ï¼Œå¦‚æœæ˜¯ AWS å®˜æ–¹åˆ™ä¸éœ€è¦ä¸“é—¨æŒ‡å®šï¼Œå¦‚æœæ˜¯ R2 æˆ–è‡ªå»º Minio åˆ™å¿…é¡»æŒ‡å®š)
4. **Region** (åŒºåŸŸï¼Œå¦‚ `us-east-1`ï¼ŒR2 å¯ä»¥å¡« `auto`)
![image.png](https://imgu.falnsakura.top/PicGo/2026/01/c21a7f159b648959889d24f62738abf8.png)

## ä¸ºä»€ä¹ˆé€‰æ‹© Cloudflare R2 ï¼Ÿ

Cloudflare R2 æ˜¯å…¼å®¹ S3 æ ‡å‡†çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œå®ƒæœ€å¤§çš„æ€æ‰‹é”æ˜¯ï¼š**å…æ”¶å‡ºå£æµé‡è´¹ï¼ˆZero Egress Feesï¼‰**ã€‚

ä¼ ç»Ÿçš„äº‘å‚å•†ï¼ˆå¦‚ AWS æˆ–é˜¿é‡Œäº‘ï¼‰é€šå¸¸ä¼šå¯¹å›¾ç‰‡åŠ è½½äº§ç”Ÿçš„æµé‡æ”¶è´¹ï¼Œå¦‚æœä½ çš„åšå®¢è®¿é—®é‡å¤§ï¼Œè¿™ç¬”è´¹ç”¨ä¼šå¾ˆå¯è§‚ã€‚è€Œ Cloudflare R2ï¼š

**1. æ¯æœˆå‰ 10GB å­˜å‚¨å…è´¹**ã€‚

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/b27077e30ca0fc6ee12ea1ab58791b11.png)

**2. æ¯æœˆ A ç±»æ“ä½œï¼ˆå†™ï¼‰100 ä¸‡æ¬¡å…è´¹ï¼ŒB ç±»æ“ä½œï¼ˆè¯»ï¼‰1000 ä¸‡æ¬¡å…è´¹**ã€‚

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/3d969ddb34ac79b28e942bc965783d90.png)

**3. å®Œå…¨æ²¡æœ‰æµé‡è´¹**ã€‚

å¯¹äºä¸ªäººæ¥è¯´ï¼Œè¿™å‡ ä¹å°±æ˜¯æ°¸ä¹…å…è´¹ã€‚
## æ­å»ºæ­¥éª¤

### 1. å¼€å¯ Cloudflare R2

ç™»å½• Cloudflare æ§åˆ¶å°ï¼Œç‚¹å‡»å·¦ä¾§èœå•æ çš„ `R2`ã€‚ä½ éœ€è¦ç»‘å®šä¸€å¼ ä¿¡ç”¨å¡æˆ– PayPal è¿›è¡Œèº«ä»½éªŒè¯ï¼ˆè™½ç„¶åœ¨å…è´¹é¢åº¦å†…ä¸ä¼šæ‰£è´¹ï¼‰ã€‚

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/4409c8c8a36a4daa3705533f520a6b94.png)

>å¦‚æœ API è°ƒç”¨æˆ–è€…å­˜å‚¨å®¹é‡è¶…äº† Free Tier ä¼šæ‰£é’±çš„
![image.png](https://imgu.falnsakura.top/PicGo/2026/01/09a77ba692bbd15bfe8cefc5b3db7bab.png)

>æˆ‘ç”¨çš„æ˜¯å·¥è¡Œæ˜Ÿåº§å¡ï¼ˆå…å¹´è´¹ğŸ˜‹ï¼‰ï¼Œæ³¨å†Œä¸€ä¸ªéå›½åŒº PayPal ä¹Ÿå¯ä»¥ï¼Œèƒ½ç»‘é“¶è”å¡ã€‚

![fe04b05c774a9ced9931acc98d334641.png](https://imgu.falnsakura.top/PicGo/2026/01/f4f7779838a094ecfdf126facdeeecbd.png)
### 2. åˆ›å»º Bucketï¼ˆæ¡¶ï¼‰

ç‚¹å‡» `Create bucket`ï¼Œèµ·ä¸€ä¸ªåå­—ï¼ˆä¾‹å¦‚ `my-blog-images`ï¼‰ï¼ŒåŒºåŸŸé€‰æ‹© `Automatic` å³å¯ã€‚

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/9f0ae89c39f61919ba3802bfec7e8bc2.png)

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/c45b517cd587b1005a6d388e50ccd0f7.png)

### 3. é…ç½®å…¬å¼€è®¿é—®

R2 é»˜è®¤ä¸å…è®¸å…¬å¼€è®¿é—®ï¼Œåªèƒ½é€šè¿‡ API è®¿é—®ã€‚è‹¥æƒ³æ­å»ºå›¾åºŠä¹‹ç±»çš„å¹¶èƒ½ç›´æ¥è®¿é—®ï¼Œéœ€è¦é…ç½®æœ‰åŸŸåã€‚

åœ¨ Bucket è¯¦æƒ…é¡µä¸­ï¼Œé€‰æ‹© `Settings` é€‰é¡¹å¡ï¼š
* æ‰¾åˆ° **Custom Domain**ã€‚
* ç‚¹å‡» **Add**ï¼Œè¾“å…¥ä½ çš„å­åŸŸåï¼ˆä¾‹å¦‚ `img.yourdomain.com`ï¼‰ã€‚
* è¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡è‡ªå·±çš„åŸŸåè®¿é—®å›¾ç‰‡äº†ï¼Œä¸”è‡ªå¸¦ CDN åŠ é€Ÿã€‚
![image.png](https://imgu.falnsakura.top/PicGo/2026/01/63e384cc54f9de5b890751d6d455287d.png)

>å¦‚æœä½ çš„åŸŸåæ²¡æœ‰æ”¾åœ¨ Cloudflare æ‰˜ç®¡ï¼Œå¯ä»¥å°†åŸŸåè¿ç§»åˆ° Cloudflareï¼Œæˆ–è€…ä½¿ç”¨ Cloudflare Workers ä¸­è½¬ã€‚
>å¦‚æœä½ åªæƒ³æ¬å­åŸŸåï¼ˆä¾‹å¦‚ `img.abc.com`ï¼‰ï¼Œå¯ä»¥åœ¨ä½ åŸæ¥çš„æœåŠ¡å•†é‚£é‡Œï¼ŒæŠŠ `img` è¿™ä¸ªå­åŸŸåçš„ **NS è®°å½•** æŒ‡å‘ Cloudflare åˆ†é…ç»™ä½ çš„ NS åœ°å€ã€‚è¿™å«â€œDNS å§”æ´¾â€ã€‚
>å¦‚æœåœ¨ Cloudflare ï¼Œcf ä¼šè‡ªåŠ¨å¸®ä½ æ·»åŠ  DNSè®°å½•ã€‚


![image.png](https://imgu.falnsakura.top/PicGo/2026/01/f443956fbd30d12f35c64d8b0df2798e.png)

### 4. è·å– API å¯†é’¥
	
å›åˆ° R2 ä¸»é¡µï¼Œç‚¹å‡»å³ä¾§çš„ **Manage** ï¼š
![image.png](https://imgu.falnsakura.top/PicGo/2026/01/77a40acffcef2ef6d45b80504eda5fcb.png)

* ç‚¹å‡» **Create User API token**ã€‚

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/c10e8781e73fe79d099862091ecfc06c.png)

* æƒé™é€‰æ‹© **Object Read & Write**ã€‚
![image.png](https://imgu.falnsakura.top/PicGo/2026/01/5b6071e2f933ed3068a1e78f292fe29f.png)
* ä¿å­˜å¥½ç”Ÿæˆçš„ `Access Key ID` å’Œ `Secret Access Key`ï¼Œä»¥åŠ `Endpoint`ã€‚
## é…ç½® CORS ç­–ç•¥

**CORS (Cross-Origin Resource Sharing) æ˜¯ä¸€ç§å®‰å…¨æœºåˆ¶ã€‚ç®€å•æ¥è¯´ï¼Œç”±äºæµè§ˆå™¨çš„â€œåŒæºç­–ç•¥â€ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸŸå A çš„ç½‘é¡µä¸å…è®¸å»è¯»åŸŸå B çš„èµ„æºã€‚

å¦‚æœä½ åœ¨ `blog.com` ä¸Šå¼•ç”¨äº† `img.com` çš„å›¾ç‰‡ï¼Œå¹¶ä¸”ä½ éœ€è¦é€šè¿‡è„šæœ¬ï¼ˆæ¯”å¦‚ Canvas å¤„ç†ã€å›¾ç‰‡æ‡’åŠ è½½æ’ä»¶ç­‰ï¼‰å»æ“ä½œè¿™å¼ å›¾ç‰‡ï¼Œå°±å¿…é¡»åœ¨ `img.com`ï¼ˆå³ R2 å­˜å‚¨æ¡¶ï¼‰ä¸Šæ˜ç¡®å…è®¸ `blog.com` çš„è®¿é—®ã€‚

### 1. è¿›å…¥è®¾ç½®ç•Œé¢

1. ç™»å½• Cloudflare æ§åˆ¶å°ã€‚
2. ç‚¹å‡»å·¦ä¾§ **R2**ï¼Œé€‰æ‹©ä½ åˆ›å»ºå¥½çš„ **Bucketï¼ˆå­˜å‚¨æ¡¶ï¼‰**ã€‚
3. ç‚¹å‡»ä¸Šæ–¹çš„ **Settings** é€‰é¡¹å¡ã€‚
4. å‘ä¸‹æ»šåŠ¨æ‰¾åˆ° **CORS Policy** éƒ¨åˆ†ï¼Œç‚¹å‡» **Add CORS policy**ã€‚
![image.png](https://imgu.falnsakura.top/PicGo/2026/01/4341e285db6a4d67dc0d56c16add0477.png)

### 2. å¡«å†™é…ç½®æ–‡ä»¶
åœ¨å¼¹å‡ºçš„ç¼–è¾‘æ¡†ä¸­ï¼Œå¤åˆ¶å¹¶ç²˜è´´ä»¥ä¸‹ JSON ä»£ç ï¼š
```json
[
Â  {
Â  Â  "AllowedOrigins": [
Â  Â  Â  "*"
Â  Â  ],
Â  Â  "AllowedMethods": [
Â  Â  Â  "GET",
Â  Â  Â  "PUT",
Â  Â  Â  "POST",
Â  Â  Â  "DELETE",
Â  Â  Â  "HEAD"
Â  Â  ],
Â  Â  "AllowedHeaders": [
Â  Â  Â  "*"
Â  Â  ],
Â  Â  "ExposeHeaders": [],
Â  Â  "MaxAgeSeconds": 3000
Â  }
]
```
## é…åˆ PicGo å®ç°è‡ªåŠ¨åŒ–ä¸Šä¼ 

æ‰‹åŠ¨ä¸Šä¼ å›¾ç‰‡å¾ˆéº»çƒ¦ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ **PicGo** å®¢æˆ·ç«¯ï¼š

1. åœ¨ PicGo ä¸­å®‰è£… `s3` æ’ä»¶ã€‚

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/24a0dca488b42d1bd4088208fd8f09e5.png)

2. é…ç½®æ’ä»¶å‚æ•°ï¼š
* **åº”ç”¨å¯†é’¥ ID**ï¼šä½ çš„ Access Key IDã€‚
* **åº”ç”¨å¯†é’¥**ï¼šä½ çš„ Secret Access Keyã€‚
* **æ¡¶å**ï¼š`my-blog-images`ã€‚
* **è‡ªå®šä¹‰èŠ‚ç‚¹**ï¼šä½ çš„ R2 Endpointï¼ˆå»æ‰æœ«å°¾çš„æ¡¶åéƒ¨åˆ†ï¼‰ã€‚
* **è‡ªå®šä¹‰åŸŸå**ï¼šä½ ç»‘å®šçš„è‡ªå®šä¹‰åŸŸåï¼ˆå¦‚ `https://img.yourdomain.com`ï¼‰ã€‚
![image.png](https://imgu.falnsakura.top/PicGo/2026/01/420912d092611b7ba6094c8f1f0cd310.png)

> å¯ä»¥é…åˆå›¾ç‰‡å‹ç¼©é£Ÿç”¨ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œä¸ä¼šç‰ºç‰²å¤ªå¤šå›¾ç‰‡è´¨é‡
## æŠŠ PicGo æ”¾åˆ° Obsidian å®ç°å›¾ç‰‡æ— ç¼ä¸Šä¼ 

1. å®‰è£… `Image auto upload` æ’ä»¶

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/d5856c40359e85599dfd931501638ad5.png)

2. é…ç½®æ’ä»¶

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/2e692fdeebd3a3d303560ee6cd8b65c7.png)

é…ç½®å®Œæˆåï¼Œåœ¨å†™ md çš„æ—¶å€™æŠŠå›¾ç‰‡å¤åˆ¶è¿›æ¥ï¼Œå›¾ç‰‡ä¼šè‡ªåŠ¨ä¸Šä¼ åˆ° R2ã€‚å†ä¹Ÿä¸ç”¨æ“å¿ƒä¼  md è¿˜å¾—ä¼ å›¾ç‰‡çš„é—®é¢˜äº†ğŸ˜‹ã€‚
## é…ç½® Cloudflare ä¼˜é€‰åŸŸå

å¦‚æœå«Œå›½å†…è®¿é—®å¤ªæ…¢ï¼Œå¯ä»¥ç”¨ Cloudflare Workers åä»£æ¥é…ç½® Cloudflare ä¼˜é€‰åŸŸåã€‚
```javascript
export default {
Â  async fetch(request) {
Â  Â  const url = new URL(request.url);
Â  Â  url.hostname = 'img.yourdomain.com';
Â  Â  return fetch(url, request);
Â  },
};
```

å†æ·»åŠ  Workers è·¯ç”±ï¼ŒæŠŠ DNS è®°å½•é‡Œçš„ CNAME æŒ‡å‘çš„åŸŸåæ”¹æˆ Cloudflare ä¼˜é€‰åŸŸåå³å¯ã€‚

ä¼˜é€‰å‰ï¼Œåªè§£æåˆ°äº†ä¸¤ä¸ª IP

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/37ad2ade0c2312357a29635e61b745b3.png)

ä¼˜é€‰å

![image.png](https://imgu.falnsakura.top/PicGo/2026/01/b2adaa7d951fbc5a4d88f6a787e66b47.png)


æ­å»ºå®Œæˆåï¼Œä½ å°±å¯ä»¥è®¿é—® `https://img.yourdomain.com/bucketname/path` è®¿é—®ä½ çš„å›¾ç‰‡äº†ã€‚